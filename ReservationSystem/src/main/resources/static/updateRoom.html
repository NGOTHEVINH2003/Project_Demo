<!DOCTYPE html>
<html lang="en">
<head>
    <title></title>
</head>
<body>
<form id="roomForm">
    <label for="id">ID: </label>
    <input type="text" id="id" required>
    <br>
    <label for="price">Price: </label>
    <input type="text" id="price" required>
    <br>
    <label for="type">Type: </label>
    <input type="text" id="type" required>
    <br>
    <label for="address">Address: </label>
    <input type="text" id="address" required>
    <br>
    <label for="imgdata">Image Url: </label>
    <input type="text" id="imgdata" required>
    <br>
    <label for="isbooked">IsBooked</label>
    <input type="checkbox" id="isbooked">
    <br>
    <button type="button" onclick="updateRoom()">Update Room</button>
    <button type="reset">Reset</button>
</form>
<script>
    function updateRoom() {
            var roomIdToUpdate = document.getElementById("id").value;
            var updatedPrice = document.getElementById("price").value;
            var updatedType = document.getElementById("type").value;
            var updatedAddress = document.getElementById("address").value;
            var updatedImgData = document.getElementById("imgdata").value;
            var updatedIsBooked = document.getElementById("isbooked").checked;

            var updatedRoomData = {
                id: roomIdToUpdate,
                price: updatedPrice,
                roomType: updatedType,
                address: updatedAddress,
                img_url: updatedImgData,
                booked: updatedIsBooked
            };

            fetch(`/room/update/${roomIdToUpdate}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(updatedRoomData)
            })
            .then(response => {
                if (response.ok) {
                    console.log(`Room with ID ${roomIdToUpdate} updated successfully`);
                    updateRoomList();
                } else {
                    console.error('Error updating room');
                }
            })
            .catch(error => console.error('Error:', error));
        }
</script>

<br>
<h3>List Room</h3>
<div id="roomList"></div>
<script>
function deleteRoom(roomId) {
    fetch(`/room/delete/${roomId}`, {
        method: 'DELETE',
        headers: {
            'Content-Type': 'application/json'
        },
    })
    .then(response => {
        if (response.ok) {
            console.log(`Room with ID ${roomId} deleted successfully`);
            updateRoomList();
        } else {
            console.error('Error deleting room');
        }
    })
    .catch(error => console.error('Error:', error));
}

function updateRoomList() {
    const roomListDiv = document.getElementById('roomList');

    while (roomListDiv.firstChild) {
        roomListDiv.removeChild(roomListDiv.firstChild);
    }

    fetch('room')
        .then(response => response.json())
        .then(data => {
            data.forEach(room => {
                const roomDiv = document.createElement('div');
                roomDiv.textContent = `Room ID: ${room.id}, Type: ${room.roomType}, Price: ${room.price}, Address: ${room.address}, Url: ${room.img_url}, Status: ${room.booked}`;

                const deleteLink = document.createElement('a');
                deleteLink.href = '#';
                deleteLink.textContent = 'Delete';
                deleteLink.addEventListener('click', function() {
                    deleteRoom(room.id);
                });

                roomDiv.appendChild(deleteLink);

                roomListDiv.appendChild(roomDiv);
            });
        })
        .catch(error => console.error('Error:', error));
}

updateRoomList();

</script>

</body>
</html>
