<!DOCTYPE html>
<html lang="en">
<head>
    <title></title>
</head>
<body>
<img src="image/dog.jpg" alt="hello">
<form id="roomForm">
    <label for="price">Price: </label>
    <input type="text" id="price" required>
    <br>
    <label for="type">Type: </label>
    <input type="text" id="type" required>
    <br>
    <label for="address">Address: </label>
    <input type="text" id="address" required>
    <br>
    <label for="imgdata">Image URL:</label>
    <input type="file" id="imgdata" accept="image/*" onchange="handleFileChange()">
    <br>
    <label for="isbooked">IsBooked</label>
    <input type="checkbox" id="isbooked">
    <br>
    <button type="button" onclick="addRoom()">Add Room</button>
    <button type="reset">Reset</button>
</form>
<script>
    let selectedFile = null;

    function handleFileChange() {
        const imgdataInput = document.getElementById('imgdata');
        selectedFile = imgdataInput.files[0];
    }

    function addRoom() {
        var price = document.getElementById("price").value;
        var type = document.getElementById("type").value;
        var address = document.getElementById("address").value;
        var isBooked = document.getElementById("isbooked").checked ? true : false;

        var roomData = new FormData();
        roomData.append('price', price);
        roomData.append('roomType', type);
        roomData.append('address', address);
        roomData.append('booked', isBooked);
        roomData.append('imgdata', selectedFile);

        console.log(selectedFile);  // Kiểm tra dữ liệu trên console

        fetch('/room/add', {
            method: 'POST',
            body: roomData,  // Không cần header 'Content-Type' ở đây
        })
        .then(response => {
            if (response.ok) {
                return response.text();
            }
            throw new Error('Network response was not ok.');
        })
        .then(data => {
            console.log('Room added successfully:', data);
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }

</script>

<br>
<h3>List Room</h3>
<div id="roomList"></div>
<script>
    fetch('room')
    .then(response => response.json())
    .then(data => {
        const roomListDiv = document.getElementById('roomList');
        data.forEach(room => {
            const roomDiv = document.createElement('div');

            const imgElement = document.createElement('img');
            imgElement.src = room.img_url;

           console.log(room.img_url);

            roomDiv.appendChild(imgElement);

            roomDiv.innerHTML += `Room ID: ${room.id}, Type:${room.roomType}, Price: ${room.price}, Address: ${room.address}, Status: ${room.booked}`;

            roomListDiv.appendChild(roomDiv);
        });
    })
    .catch(error => console.error('Error:', error));

</script>

</body>
</html>
